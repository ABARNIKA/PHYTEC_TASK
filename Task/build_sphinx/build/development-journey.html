

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3. Development Journey &mdash; CONTIKI-NG efr32zg28b312f1024im48-board Implementation - PHYTEC EMBEDDED PVT. LTD.</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Solutions Implemented" href="solutions-implemented.html" />
    <link rel="prev" title="2. Hardware Specifications" href="hardware.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html" class="icon icon-home">
            CONTIKI-NG efr32zg28b312f1024im48-board Implementation - PHYTEC EMBEDDED PVT. LTD.
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware.html">2. Hardware Specifications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Development Journey</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#phase-1-initial-contiki-ng-integration">3.1. Phase 1: Initial Contiki-NG Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#objective">3.1.1. Objective</a></li>
<li class="toctree-l3"><a class="reference internal" href="#approach">3.1.2. Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#challenges-encountered">3.1.3. Challenges Encountered</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">3.1.4. Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#files-created">3.1.5. Files Created</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phase-2-bare-metal-solutions">3.2. Phase 2: Bare Metal Solutions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">3.2.1. Objective</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-approaches">3.2.2. Multiple Approaches</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#direct-register-access">3.2.2.1. Direct Register Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#silicon-labs-style-implementation">3.2.2.2. Silicon Labs Style Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minimal-implementation">3.2.2.3. Minimal Implementation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#results-analysis">3.2.3. Results Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compilation-success">3.2.3.1. Compilation Success</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flash-programming-success">3.2.3.2. Flash Programming Success</a></li>
<li class="toctree-l4"><a class="reference internal" href="#runtime-failure-analysis">3.2.3.3. Runtime Failure Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#key-insights">3.2.4. Key Insights</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">3.2.5. Files Created</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phase-3-trustzone-security-analysis">3.3. Phase 3: TrustZone Security Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">3.3.1. Objective</a></li>
<li class="toctree-l3"><a class="reference internal" href="#security-investigation">3.3.2. Security Investigation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#trustzone-architecture-analysis">3.3.2.1. TrustZone Architecture Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smu-register-analysis">3.3.2.2. SMU Register Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gpio-security-configuration">3.3.2.3. GPIO Security Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bypass-attempts">3.3.3. Bypass Attempts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#security-state-switching">3.3.3.1. Security State Switching</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smu-reconfiguration">3.3.3.2. SMU Reconfiguration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clock-domain-manipulation">3.3.3.3. Clock Domain Manipulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#results-summary">3.3.4. Results Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#critical-finding">3.3.5. Critical Finding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">3.3.6. Files Created</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phase-4-silicon-labs-ecosystem-integration">3.4. Phase 4: Silicon Labs Ecosystem Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">3.4.1. Objective</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simplicity-studio-5-project">3.4.2. Simplicity Studio 5 Project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#project-configuration">3.4.2.1. Project Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#application-implementation">3.4.2.2. Application Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trustzone-aware-led-control">3.4.2.3. TrustZone-Aware LED Control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#success-metrics">3.4.3. Success Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#technical-analysis">3.4.4. Technical Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#why-ss5-works">3.4.4.1. Why SS5 Works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#critical-components">3.4.4.2. Critical Components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id6">3.4.5. Files Created</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phase-5-comprehensive-testing-and-validation">3.5. Phase 5: Comprehensive Testing and Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">3.5.1. Objective</a></li>
<li class="toctree-l3"><a class="reference internal" href="#progressive-testing-strategy">3.5.2. Progressive Testing Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#test-case-development">3.5.2.1. Test Case Development</a></li>
<li class="toctree-l4"><a class="reference internal" href="#automated-testing-framework">3.5.2.2. Automated Testing Framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#comprehensive-debugging-scripts">3.5.3. Comprehensive Debugging Scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hardware-validation">3.5.3.1. Hardware Validation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#results-compilation">3.5.4. Results Compilation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#final-test-matrix">3.5.4.1. Final Test Matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">3.5.5. Files Created</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#development-journey-summary">3.6. Development Journey Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#key-learnings">3.6.1. Key Learnings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timeline-overview">3.6.2. Timeline Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">3.6.3. Success Metrics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="solutions-implemented.html">4. Solutions Implemented</a></li>
<li class="toctree-l1"><a class="reference internal" href="trustzone-analysis.html">5. TrustZone Security Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="gecko-sdk-integration.html">6. Gecko SDK Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="files-created.html">7. Files Created</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">8. Troubleshooting Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="future-work.html">9. Future Work and Recommendations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CONTIKI-NG efr32zg28b312f1024im48-board Implementation - PHYTEC EMBEDDED PVT. LTD.</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">3. </span>Development Journey</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/contiki-ng/contiki-ng/blob/develop/examples/efr32zg28-led-blink/source/development-journey.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="development-journey">
<h1><span class="section-number">3. </span>Development Journey<a class="headerlink" href="#development-journey" title="Link to this heading"></a></h1>
<p>This section documents the complete development journey, from initial Contiki-NG integration attempts through the final working solutions.</p>
<section id="phase-1-initial-contiki-ng-integration">
<h2><span class="section-number">3.1. </span>Phase 1: Initial Contiki-NG Integration<a class="headerlink" href="#phase-1-initial-contiki-ng-integration" title="Link to this heading"></a></h2>
<section id="objective">
<h3><span class="section-number">3.1.1. </span>Objective<a class="headerlink" href="#objective" title="Link to this heading"></a></h3>
<p>Create a standard Contiki-NG LED blink application using the existing GPIO drivers and platform support.</p>
</section>
<section id="approach">
<h3><span class="section-number">3.1.2. </span>Approach<a class="headerlink" href="#approach" title="Link to this heading"></a></h3>
<p>Started with a conventional Contiki-NG application structure:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">led-blink-contiki.c - Initial Approach</span><a class="headerlink" href="#id10" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;contiki.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;dev/leds.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="n">PROCESS</span><span class="p">(</span><span class="n">led_blink_process</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LED Blink Process&quot;</span><span class="p">);</span>
<span class="n">AUTOSTART_PROCESSES</span><span class="p">(</span><span class="o">&amp;</span><span class="n">led_blink_process</span><span class="p">);</span>

<span class="n">PROCESS_THREAD</span><span class="p">(</span><span class="n">led_blink_process</span><span class="p">,</span><span class="w"> </span><span class="n">ev</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">etimer</span><span class="w"> </span><span class="n">timer</span><span class="p">;</span>

<span class="w">  </span><span class="n">PROCESS_BEGIN</span><span class="p">();</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Starting LED blink process</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">etimer_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">timer</span><span class="p">,</span><span class="w"> </span><span class="n">CLOCK_SECOND</span><span class="p">);</span>
<span class="w">    </span><span class="n">PROCESS_WAIT_EVENT_UNTIL</span><span class="p">(</span><span class="n">etimer_expired</span><span class="p">(</span><span class="o">&amp;</span><span class="n">timer</span><span class="p">));</span>

<span class="w">    </span><span class="n">leds_toggle</span><span class="p">(</span><span class="n">LEDS_ALL</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;LED toggled</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">PROCESS_END</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="challenges-encountered">
<h3><span class="section-number">3.1.3. </span>Challenges Encountered<a class="headerlink" href="#challenges-encountered" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>GPIO Register Access Failures</strong></p>
<ul class="simple">
<li><p>Standard Contiki GPIO drivers failed to access registers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">leds_toggle()</span></code> function returned without effect</p></li>
<li><p>No error messages, but LED remained inactive</p></li>
</ul>
</li>
<li><p><strong>TrustZone Security Blocking</strong></p>
<ul class="simple">
<li><p>First indication of security-related issues</p></li>
<li><p>GPIO register reads returned “Could not read memory”</p></li>
<li><p>Standard debugging approaches ineffective</p></li>
</ul>
</li>
<li><p><strong>Build System Integration</strong></p>
<ul class="simple">
<li><p>Contiki-NG Makefile system worked correctly</p></li>
<li><p>Binary generation successful (ELF and HEX formats)</p></li>
<li><p>Flash programming completed without errors</p></li>
</ul>
</li>
</ol>
</section>
<section id="results">
<h3><span class="section-number">3.1.4. </span>Results<a class="headerlink" href="#results" title="Link to this heading"></a></h3>
<table class="docutils align-default" id="id11">
<caption><span class="caption-text">Phase 1 Results</span><a class="headerlink" href="#id11" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 20.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Aspect</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Compilation</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Clean builds with no warnings</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Flash Programming</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Binary uploaded successfully</p></td>
</tr>
<tr class="row-even"><td><p><strong>Process Execution</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Contiki scheduler running</p></td>
</tr>
<tr class="row-odd"><td><p><strong>LED Control</strong></p></td>
<td><p>❌ Failed</p></td>
<td><p>GPIO registers inaccessible</p></td>
</tr>
<tr class="row-even"><td><p><strong>Debug Output</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Printf statements working</p></td>
</tr>
</tbody>
</table>
</section>
<section id="files-created">
<h3><span class="section-number">3.1.5. </span>Files Created<a class="headerlink" href="#files-created" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">led-blink-contiki.c</span></code> - Standard Contiki approach</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minimal-contiki-blink.c</span></code> - Simplified Contiki version</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">autostart-test.c</span></code> - Autostart process testing</p></li>
</ul>
</section>
</section>
<section id="phase-2-bare-metal-solutions">
<h2><span class="section-number">3.2. </span>Phase 2: Bare Metal Solutions<a class="headerlink" href="#phase-2-bare-metal-solutions" title="Link to this heading"></a></h2>
<section id="id1">
<h3><span class="section-number">3.2.1. </span>Objective<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Bypass Contiki-NG framework limitations by implementing direct hardware control using bare metal programming.</p>
</section>
<section id="multiple-approaches">
<h3><span class="section-number">3.2.2. </span>Multiple Approaches<a class="headerlink" href="#multiple-approaches" title="Link to this heading"></a></h3>
<section id="direct-register-access">
<h4><span class="section-number">3.2.2.1. </span>Direct Register Access<a class="headerlink" href="#direct-register-access" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">bare-metal-test.c - Direct Hardware Control</span><a class="headerlink" href="#id12" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>

<span class="c1">// Hardware register definitions</span>
<span class="cp">#define CMU_BASE           0x40008000UL</span>
<span class="cp">#define GPIO_BASE          0x4003C000UL</span>

<span class="cp">#define CMU_CLKEN0         (*(volatile uint32_t*)(CMU_BASE + 0x200))</span>
<span class="cp">#define GPIO_PC_MODEL      (*(volatile uint32_t*)(GPIO_BASE + 0x30))</span>
<span class="cp">#define GPIO_PC_DOUT       (*(volatile uint32_t*)(GPIO_BASE + 0x34))</span>

<span class="c1">// Debug variables for J-Link monitoring</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">debug_main_loop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">debug_led_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">debug_cmu_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">simple_delay</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">__asm__</span><span class="p">(</span><span class="s">&quot;nop&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Enable GPIO clock</span>
<span class="w">    </span><span class="n">CMU_CLKEN0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="mi">1UL</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">debug_cmu_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CMU_CLKEN0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Configure PC8 as output</span>
<span class="w">    </span><span class="n">GPIO_PC_MODEL</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mh">0xF</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="w">    </span><span class="n">GPIO_PC_MODEL</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="mh">0x4</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Toggle LED</span>
<span class="w">        </span><span class="n">GPIO_PC_DOUT</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="p">(</span><span class="mi">1UL</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">        </span><span class="n">debug_led_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GPIO_PC_DOUT</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">        </span><span class="n">simple_delay</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span>
<span class="w">        </span><span class="n">debug_main_loop</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="silicon-labs-style-implementation">
<h4><span class="section-number">3.2.2.2. </span>Silicon Labs Style Implementation<a class="headerlink" href="#silicon-labs-style-implementation" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">silabs-brd2705a-blink.c - Board-Specific Approach</span><a class="headerlink" href="#id13" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdbool.h&gt;</span>

<span class="c1">// BRD2705A specific definitions</span>
<span class="cp">#define BRD2705A_LED1_PORT  2  </span><span class="c1">// Port C</span>
<span class="cp">#define BRD2705A_LED1_PIN   8  </span><span class="c1">// Pin 8</span>

<span class="c1">// Silicon Labs style GPIO macros</span>
<span class="cp">#define GPIO_PORT(port) ((GPIO_TypeDef *)(GPIO_BASE + (port) * 0x40))</span>
<span class="cp">#define GPIO_PinModeSet(port, pin, mode, out) \</span>
<span class="cp">    do { \</span>
<span class="cp">        volatile uint32_t *reg = &amp;GPIO_PORT(port)-&gt;MODEL; \</span>
<span class="cp">        if (pin &gt;= 8) reg = &amp;GPIO_PORT(port)-&gt;MODEH; \</span>
<span class="cp">        uint32_t shift = (pin % 8) * 4; \</span>
<span class="cp">        *reg = (*reg &amp; ~(0xF &lt;&lt; shift)) | (mode &lt;&lt; shift); \</span>
<span class="cp">        if (out) GPIO_PORT(port)-&gt;DOUT |= (1 &lt;&lt; pin); \</span>
<span class="cp">        else GPIO_PORT(port)-&gt;DOUT &amp;= ~(1 &lt;&lt; pin); \</span>
<span class="cp">    } while(0)</span>
</pre></div>
</div>
</div>
</section>
<section id="minimal-implementation">
<h4><span class="section-number">3.2.2.3. </span>Minimal Implementation<a class="headerlink" href="#minimal-implementation" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">minimal-test.c - Absolute Minimal Approach</span><a class="headerlink" href="#id14" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">volatile</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">GPIO_PC_DOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x4003C034</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">debug_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">debug_counter</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Attempt direct LED toggle</span>
<span class="w">        </span><span class="o">*</span><span class="n">GPIO_PC_DOUT</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mh">0x100</span><span class="p">;</span><span class="w">  </span><span class="c1">// Toggle bit 8 (PC8)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="results-analysis">
<h3><span class="section-number">3.2.3. </span>Results Analysis<a class="headerlink" href="#results-analysis" title="Link to this heading"></a></h3>
<section id="compilation-success">
<h4><span class="section-number">3.2.3.1. </span>Compilation Success<a class="headerlink" href="#compilation-success" title="Link to this heading"></a></h4>
<p>All bare metal approaches compiled successfully:</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Successful Build Commands</span><a class="headerlink" href="#id15" title="Link to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Direct GCC compilation</span>
arm-none-eabi-gcc<span class="w"> </span>-mcpu<span class="o">=</span>cortex-m33<span class="w"> </span>-mthumb<span class="w"> </span>-mfloat-abi<span class="o">=</span>soft<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-specs<span class="o">=</span>nosys.specs<span class="w"> </span>-T<span class="w"> </span>efr32zg28.ld<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-o<span class="w"> </span>minimal_led_blink.elf<span class="w"> </span>minimal_led_blink.c

<span class="c1"># Binary generation</span>
arm-none-eabi-objcopy<span class="w"> </span>-O<span class="w"> </span>ihex<span class="w"> </span>minimal_led_blink.elf<span class="w"> </span>minimal_led_blink.hex

<span class="c1"># Size verification</span>
arm-none-eabi-size<span class="w"> </span>minimal_led_blink.elf
<span class="c1"># Result: 264 bytes total</span>
</pre></div>
</div>
</div>
</section>
<section id="flash-programming-success">
<h4><span class="section-number">3.2.3.2. </span>Flash Programming Success<a class="headerlink" href="#flash-programming-success" title="Link to this heading"></a></h4>
<p>J-Link programming completed without errors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">J</span><span class="o">-</span><span class="n">Link</span><span class="o">&gt;</span><span class="n">loadfile</span> <span class="n">minimal_led_blink</span><span class="o">.</span><span class="n">hex</span>
<span class="n">Downloading</span> <span class="n">file</span> <span class="p">[</span><span class="n">minimal_led_blink</span><span class="o">.</span><span class="n">hex</span><span class="p">]</span><span class="o">...</span>
<span class="n">J</span><span class="o">-</span><span class="n">Link</span><span class="p">:</span> <span class="n">Flash</span> <span class="n">download</span><span class="p">:</span> <span class="n">Bank</span> <span class="mi">0</span> <span class="o">@</span> <span class="mh">0x08000000</span><span class="p">:</span> <span class="mi">1</span> <span class="nb">range</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">264</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="n">J</span><span class="o">-</span><span class="n">Link</span><span class="p">:</span> <span class="n">Flash</span> <span class="n">download</span><span class="p">:</span> <span class="n">Total</span><span class="p">:</span> <span class="mf">0.094</span><span class="n">s</span> <span class="p">(</span><span class="n">Data</span><span class="p">:</span> <span class="mf">0.002</span><span class="n">s</span><span class="p">,</span> <span class="n">Overhead</span><span class="p">:</span> <span class="mf">0.092</span><span class="n">s</span><span class="p">)</span>
<span class="n">O</span><span class="o">.</span><span class="n">K</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="runtime-failure-analysis">
<h4><span class="section-number">3.2.3.3. </span>Runtime Failure Analysis<a class="headerlink" href="#runtime-failure-analysis" title="Link to this heading"></a></h4>
<p>Despite successful compilation and flashing, GPIO access failed:</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">J-Link Debug Session</span><a class="headerlink" href="#id16" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>J-Link&gt;mem32 0x4003C034 1
Could not read memory.

J-Link&gt;w32 0x4003C034 0x100
Writing target memory failed.

J-Link&gt;regs
PC = EFFFFFFE, CycleCnt = 025621B2
XPSR = 39000003: APSR = nzCVQ, EPSR = 01000000, IPSR = 003 (HardFault)
</pre></div>
</div>
</div>
</section>
</section>
<section id="key-insights">
<h3><span class="section-number">3.2.4. </span>Key Insights<a class="headerlink" href="#key-insights" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Hardware Functionality</strong>: Board and device confirmed 100% functional</p></li>
<li><p><strong>Security Blocking</strong>: TrustZone actively preventing GPIO access</p></li>
<li><p><strong>External Tool Limitations</strong>: Standard embedded tools insufficient</p></li>
<li><p><strong>Register Protection</strong>: SMU (Security Management Unit) blocking peripherals</p></li>
</ol>
</section>
<section id="id2">
<h3><span class="section-number">3.2.5. </span>Files Created<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bare-metal-test.c</span></code> - Direct hardware control</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minimal-test.c</span></code> - Minimal implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpio_led_baremetal.c</span></code> - GPIO-focused bare metal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">silabs-brd2705a-blink.c</span></code> - Board-specific implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">silabs-gpio-direct.c</span></code> - Direct GPIO access</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">silabs-style-blink.c</span></code> - Silicon Labs conventions</p></li>
</ul>
</section>
</section>
<section id="phase-3-trustzone-security-analysis">
<h2><span class="section-number">3.3. </span>Phase 3: TrustZone Security Analysis<a class="headerlink" href="#phase-3-trustzone-security-analysis" title="Link to this heading"></a></h2>
<section id="id3">
<h3><span class="section-number">3.3.1. </span>Objective<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>Understand and document the ARM TrustZone security implementation that was blocking GPIO access.</p>
</section>
<section id="security-investigation">
<h3><span class="section-number">3.3.2. </span>Security Investigation<a class="headerlink" href="#security-investigation" title="Link to this heading"></a></h3>
<section id="trustzone-architecture-analysis">
<h4><span class="section-number">3.3.2.1. </span>TrustZone Architecture Analysis<a class="headerlink" href="#trustzone-architecture-analysis" title="Link to this heading"></a></h4>
<p>ARM Cortex-M33 with TrustZone implements hardware-based security:</p>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">Security State Detection</span><a class="headerlink" href="#id17" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Read security state registers</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">control_s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__get_CONTROL_S</span><span class="p">();</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">control_ns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__get_CONTROL_NS</span><span class="p">();</span>

<span class="c1">// Check security extension status</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">aircr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SCB</span><span class="o">-&gt;</span><span class="n">AIRCR</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">trustzone_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">aircr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SCB_AIRCR_BFHFNMINS_Msk</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
</div>
</section>
<section id="smu-register-analysis">
<h4><span class="section-number">3.3.2.2. </span>SMU Register Analysis<a class="headerlink" href="#smu-register-analysis" title="Link to this heading"></a></h4>
<p>The Security Management Unit controls peripheral access:</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">SMU Configuration Attempts</span><a class="headerlink" href="#id18" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define SMU_BASE            0x54008000UL</span>
<span class="cp">#define SMU_PPUPATD0        (*(volatile uint32_t*)(SMU_BASE + 0x50))</span>
<span class="cp">#define SMU_PPUPATD1        (*(volatile uint32_t*)(SMU_BASE + 0x54))</span>

<span class="c1">// Attempt to read SMU status</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">smu_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SMU_PPUPATD0</span><span class="p">;</span><span class="w">  </span><span class="c1">// This fails</span>

<span class="c1">// Attempt to disable protection</span>
<span class="n">SMU_PPUPATD0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">;</span><span class="w">  </span><span class="c1">// This also fails</span>
</pre></div>
</div>
</div>
</section>
<section id="gpio-security-configuration">
<h4><span class="section-number">3.3.2.3. </span>GPIO Security Configuration<a class="headerlink" href="#gpio-security-configuration" title="Link to this heading"></a></h4>
<p>Analysis of GPIO protection levels:</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">GPIO Security Mapping</span><a class="headerlink" href="#id19" title="Link to this code"></a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GPIO Registers (Base: 0x4003C000):
- GPIO_PA_CTRL   @ 0x4003C000  [SECURE]
- GPIO_PA_MODEL  @ 0x4003C004  [SECURE]
- GPIO_PA_MODEH  @ 0x4003C008  [SECURE]
- GPIO_PA_DOUT   @ 0x4003C00C  [SECURE]
- GPIO_PA_DIN    @ 0x4003C01C  [SECURE]

All GPIO registers classified as SECURE peripherals,
requiring proper TrustZone credentials for access.
</pre></div>
</div>
</div>
</section>
</section>
<section id="bypass-attempts">
<h3><span class="section-number">3.3.3. </span>Bypass Attempts<a class="headerlink" href="#bypass-attempts" title="Link to this heading"></a></h3>
<p>Multiple security bypass methods were attempted:</p>
<section id="security-state-switching">
<h4><span class="section-number">3.3.3.1. </span>Security State Switching<a class="headerlink" href="#security-state-switching" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">Security State Manipulation</span><a class="headerlink" href="#id20" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Attempt to switch to secure state</span>
<span class="kr">__asm</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;mrs r0, control    </span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">    </span><span class="s">&quot;bic r0, r0, #1     </span><span class="se">\n</span><span class="s">&quot;</span><span class="w">  </span><span class="c1">// Clear nPRIV bit</span>
<span class="w">    </span><span class="s">&quot;msr control, r0    </span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">    </span><span class="s">&quot;isb                </span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">    </span><span class="o">:::</span><span class="w"> </span><span class="s">&quot;r0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;memory&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="smu-reconfiguration">
<h4><span class="section-number">3.3.3.2. </span>SMU Reconfiguration<a class="headerlink" href="#smu-reconfiguration" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">SMU Unlock Attempts</span><a class="headerlink" href="#id21" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Multiple SMU unlock patterns tried</span>
<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">smu_unlock_sequences</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w">  </span><span class="c1">// All peripherals non-secure</span>
<span class="w">    </span><span class="mh">0x00000000</span><span class="p">,</span><span class="w">  </span><span class="c1">// All peripherals secure</span>
<span class="w">    </span><span class="mh">0xAAAAAAAA</span><span class="p">,</span><span class="w">  </span><span class="c1">// Alternating pattern</span>
<span class="w">    </span><span class="mh">0x55555555</span><span class="p">,</span><span class="w">  </span><span class="c1">// Inverse alternating</span>
<span class="w">    </span><span class="mh">0x12345678</span><span class="p">,</span><span class="w">  </span><span class="c1">// Test pattern</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
</section>
<section id="clock-domain-manipulation">
<h4><span class="section-number">3.3.3.3. </span>Clock Domain Manipulation<a class="headerlink" href="#clock-domain-manipulation" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text">Alternative Clock Configuration</span><a class="headerlink" href="#id22" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Attempt to bypass via clock manipulation</span>
<span class="cp">#define CMU_CLKEN0_FORCE    (*(volatile uint32_t*)(CMU_BASE + 0x208))</span>
<span class="cp">#define CMU_CLKEN0_DIS      (*(volatile uint32_t*)(CMU_BASE + 0x20C))</span>

<span class="c1">// Force enable all clocks</span>
<span class="n">CMU_CLKEN0_FORCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">;</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="results-summary">
<h3><span class="section-number">3.3.4. </span>Results Summary<a class="headerlink" href="#results-summary" title="Link to this heading"></a></h3>
<table class="docutils align-default" id="id23">
<caption><span class="caption-text">Security Bypass Attempts</span><a class="headerlink" href="#id23" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 40.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Result</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>SMU Register Access</strong></p></td>
<td><p>❌ Failed</p></td>
<td><p>SMU registers also protected</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Security State Switch</strong></p></td>
<td><p>❌ Failed</p></td>
<td><p>Requires secure code execution</p></td>
</tr>
<tr class="row-even"><td><p><strong>Clock Manipulation</strong></p></td>
<td><p>❌ Failed</p></td>
<td><p>Clock registers also secured</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Register Override</strong></p></td>
<td><p>❌ Failed</p></td>
<td><p>All GPIO registers protected</p></td>
</tr>
<tr class="row-even"><td><p><strong>Debug Interface</strong></p></td>
<td><p>❌ Failed</p></td>
<td><p>Debug access limited by security</p></td>
</tr>
</tbody>
</table>
</section>
<section id="critical-finding">
<h3><span class="section-number">3.3.5. </span>Critical Finding<a class="headerlink" href="#critical-finding" title="Link to this heading"></a></h3>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p><strong>TrustZone Security Cannot Be Bypassed</strong></p>
<p>The ARM TrustZone implementation on EFR32ZG28 cannot be bypassed using external tools. The security is implemented at the hardware level and requires Silicon Labs’ proprietary security keys that are only available through official development tools.</p>
</div>
</section>
<section id="id4">
<h3><span class="section-number">3.3.6. </span>Files Created<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trustzone-fix.c</span></code> - Security bypass attempts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">efr32zg28_trustzone_init.h</span></code> - TrustZone initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">efr32zg28_safe_system_init.c</span></code> - Safe system startup</p></li>
</ul>
</section>
</section>
<section id="phase-4-silicon-labs-ecosystem-integration">
<h2><span class="section-number">3.4. </span>Phase 4: Silicon Labs Ecosystem Integration<a class="headerlink" href="#phase-4-silicon-labs-ecosystem-integration" title="Link to this heading"></a></h2>
<section id="id5">
<h3><span class="section-number">3.4.1. </span>Objective<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>Use official Silicon Labs tools and SDK to properly handle TrustZone security and achieve working GPIO control.</p>
</section>
<section id="simplicity-studio-5-project">
<h3><span class="section-number">3.4.2. </span>Simplicity Studio 5 Project<a class="headerlink" href="#simplicity-studio-5-project" title="Link to this heading"></a></h3>
<section id="project-configuration">
<h4><span class="section-number">3.4.2.1. </span>Project Configuration<a class="headerlink" href="#project-configuration" title="Link to this heading"></a></h4>
<p>Created a complete SS5 project with proper TrustZone handling:</p>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text">efr32zg28_contiki.slcp - SS5 Project Configuration</span><a class="headerlink" href="#id24" title="Link to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">project_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">efr32zg28_contiki</span>
<span class="nt">label</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EFR32ZG28 Contiki-NG LED Blink</span>
<span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example</span>
<span class="nt">package</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform</span>
<span class="nt">quality</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>

<span class="nt">component</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">device_init</span><span class="p p-Indicator">}</span><span class="w">        </span><span class="c1"># TrustZone initialization</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">device_init_hfxo</span><span class="p p-Indicator">}</span><span class="w">   </span><span class="c1"># Clock initialization</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">power_manager</span><span class="p p-Indicator">}</span><span class="w">      </span><span class="c1"># Power management</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">simple_led</span><span class="p p-Indicator">}</span><span class="w">         </span><span class="c1"># LED component with security</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">sl_system</span><span class="p p-Indicator">}</span><span class="w">          </span><span class="c1"># System initialization</span>
</pre></div>
</div>
</div>
</section>
<section id="application-implementation">
<h4><span class="section-number">3.4.2.2. </span>Application Implementation<a class="headerlink" href="#application-implementation" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-text">ss5_contiki_main.c - Hybrid SS5/Contiki Application</span><a class="headerlink" href="#id25" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sl_component_catalog.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sl_system_init.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sl_power_manager.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sl_simple_led_instances.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;app.h&quot;</span>

<span class="c1">// Contiki integration</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;contiki.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sys/process.h&quot;</span>

<span class="c1">// Debug variables for monitoring</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">debug_led_toggle_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">debug_system_ticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">debug_led_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// Initialize Silicon Labs components (handles TrustZone)</span>
<span class="w">  </span><span class="n">sl_system_init</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Initialize Contiki-NG</span>
<span class="w">  </span><span class="n">process_init</span><span class="p">();</span>
<span class="w">  </span><span class="n">process_start</span><span class="p">(</span><span class="o">&amp;</span><span class="n">etimer_process</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Start application</span>
<span class="w">  </span><span class="n">app_init</span><span class="p">();</span>

<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Silicon Labs power management</span>
<span class="w">    </span><span class="n">sl_power_manager_step</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Contiki process scheduling</span>
<span class="w">    </span><span class="n">process_run</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Application processing</span>
<span class="w">    </span><span class="n">app_process_action</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="trustzone-aware-led-control">
<h4><span class="section-number">3.4.2.3. </span>TrustZone-Aware LED Control<a class="headerlink" href="#trustzone-aware-led-control" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id26">
<div class="code-block-caption"><span class="caption-text">app_process.c - Secure LED Control</span><a class="headerlink" href="#id26" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;sl_simple_led_instances.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;app.h&quot;</span>

<span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">led_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="k">static</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">blink_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">app_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// LED initialization handled by Silicon Labs components</span>
<span class="w">  </span><span class="c1">// TrustZone security automatically configured</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">app_process_action</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">last_tick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">current_tick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_sleeptimer_get_tick_count</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Blink every second (assuming 32kHz sleeptimer)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_tick</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">last_tick</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">32768</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">led_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">led_state</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">led_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sl_led_turn_on</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sl_led_led1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sl_led_turn_off</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sl_led_led1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">blink_counter</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">debug_led_toggle_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blink_counter</span><span class="p">;</span>
<span class="w">    </span><span class="n">debug_led_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">led_state</span><span class="p">;</span>

<span class="w">    </span><span class="n">last_tick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_tick</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="success-metrics">
<h3><span class="section-number">3.4.3. </span>Success Metrics<a class="headerlink" href="#success-metrics" title="Link to this heading"></a></h3>
<p>The SS5 integration achieved complete success:</p>
<table class="docutils align-default" id="id27">
<caption><span class="caption-text">SS5 Integration Results</span><a class="headerlink" href="#id27" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 20.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>TrustZone Init</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Proper security configuration</p></td>
</tr>
<tr class="row-odd"><td><p><strong>GPIO Access</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Full register access granted</p></td>
</tr>
<tr class="row-even"><td><p><strong>LED Control</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Visible LED blinking achieved</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Debug Monitoring</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Variables accessible via J-Link</p></td>
</tr>
<tr class="row-even"><td><p><strong>Power Management</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Proper low-power operation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Contiki Integration</strong></p></td>
<td><p>✅ Success</p></td>
<td><p>Hybrid application working</p></td>
</tr>
</tbody>
</table>
</section>
<section id="technical-analysis">
<h3><span class="section-number">3.4.4. </span>Technical Analysis<a class="headerlink" href="#technical-analysis" title="Link to this heading"></a></h3>
<section id="why-ss5-works">
<h4><span class="section-number">3.4.4.1. </span>Why SS5 Works<a class="headerlink" href="#why-ss5-works" title="Link to this heading"></a></h4>
<ol class="arabic simple">
<li><p><strong>Proper Security Keys</strong>: SS5 includes Silicon Labs’ proprietary TrustZone keys</p></li>
<li><p><strong>Component System</strong>: Automated security configuration through SLC components</p></li>
<li><p><strong>TrustZone Support</strong>: Built-in security state management</p></li>
<li><p><strong>Hardware Abstraction</strong>: Proper peripheral access layer</p></li>
</ol>
</section>
<section id="critical-components">
<h4><span class="section-number">3.4.4.2. </span>Critical Components<a class="headerlink" href="#critical-components" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">device_init</span></code>: Handles TrustZone security initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simple_led</span></code>: Provides secure LED control abstraction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sl_system</span></code>: Core system with security support</p></li>
</ul>
</section>
</section>
<section id="id6">
<h3><span class="section-number">3.4.5. </span>Files Created<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p>SS5 Project Structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ss5_project/
├── efr32zg28_contiki.slcp     # Project configuration
├── efr32zg28_contiki.slps     # Project settings
├── ss5_contiki_main.c         # Main application
├── app_init.h/c               # Application initialization
├── app_process.h/c            # Application processing
└── config/                    # Component configurations
</pre></div>
</div>
</section>
</section>
<section id="phase-5-comprehensive-testing-and-validation">
<h2><span class="section-number">3.5. </span>Phase 5: Comprehensive Testing and Validation<a class="headerlink" href="#phase-5-comprehensive-testing-and-validation" title="Link to this heading"></a></h2>
<section id="id7">
<h3><span class="section-number">3.5.1. </span>Objective<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<p>Validate all approaches and create comprehensive testing framework for future development.</p>
</section>
<section id="progressive-testing-strategy">
<h3><span class="section-number">3.5.2. </span>Progressive Testing Strategy<a class="headerlink" href="#progressive-testing-strategy" title="Link to this heading"></a></h3>
<section id="test-case-development">
<h4><span class="section-number">3.5.2.1. </span>Test Case Development<a class="headerlink" href="#test-case-development" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id28">
<div class="code-block-caption"><span class="caption-text">test1_minimal_blink.c - Progressive Test Case</span><a class="headerlink" href="#id28" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Test 1: Absolute minimal functionality</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">test1_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">test1_counter</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Minimal delay</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="k">volatile</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id29">
<div class="code-block-caption"><span class="caption-text">test2_register_inspect.c - Hardware Analysis</span><a class="headerlink" href="#id29" title="Link to this code"></a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Test 2: Register inspection and analysis</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">gpio_base_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GPIO_BASE</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cmu_base_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CMU_BASE</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">test2_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Attempt register reads for analysis</span>
<span class="w">    </span><span class="n">test2_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// Mark test start</span>

<span class="w">    </span><span class="c1">// Test accessible registers</span>
<span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cpuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SCB</span><span class="o">-&gt;</span><span class="n">CPUID</span><span class="p">;</span>
<span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">icsr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SCB</span><span class="o">-&gt;</span><span class="n">ICSR</span><span class="p">;</span>

<span class="w">    </span><span class="n">test2_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// Mark success</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="automated-testing-framework">
<h4><span class="section-number">3.5.2.2. </span>Automated Testing Framework<a class="headerlink" href="#automated-testing-framework" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id30">
<div class="code-block-caption"><span class="caption-text">ultimate_troubleshooting.sh - Progressive Testing</span><a class="headerlink" href="#id30" title="Link to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;=== EFR32ZG28 Ultimate Troubleshooting ===&quot;</span>

<span class="c1"># Test 1: Hardware connection</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing hardware connection...&quot;</span>
JLinkExe<span class="w"> </span>-device<span class="w"> </span>EFR32ZG28B312F1024IM48-A<span class="w"> </span>-if<span class="w"> </span>SWD<span class="w"> </span>-speed<span class="w"> </span><span class="m">4000</span><span class="w"> </span>-autoconnect<span class="w"> </span><span class="m">1</span><span class="w"> </span>-CommanderScript<span class="w"> </span>test_connection.jlink

<span class="c1"># Test 2: Flash programming</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing flash programming...&quot;</span>
arm-none-eabi-gcc<span class="w"> </span>-mcpu<span class="o">=</span>cortex-m33<span class="w"> </span>-mthumb<span class="w"> </span>-specs<span class="o">=</span>nosys.specs<span class="w"> </span>-T<span class="w"> </span>efr32zg28.ld<span class="w"> </span>-o<span class="w"> </span>test1.elf<span class="w"> </span>test1_minimal_blink.c
arm-none-eabi-objcopy<span class="w"> </span>-O<span class="w"> </span>ihex<span class="w"> </span>test1.elf<span class="w"> </span>test1.hex
JLinkExe<span class="w"> </span>-device<span class="w"> </span>EFR32ZG28B312F1024IM48-A<span class="w"> </span>-if<span class="w"> </span>SWD<span class="w"> </span>-speed<span class="w"> </span><span class="m">4000</span><span class="w"> </span>-CommanderScript<span class="w"> </span>flash_test1.jlink

<span class="c1"># Test 3: Runtime monitoring</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing runtime execution...&quot;</span>
JLinkExe<span class="w"> </span>-device<span class="w"> </span>EFR32ZG28B312F1024IM48-A<span class="w"> </span>-if<span class="w"> </span>SWD<span class="w"> </span>-speed<span class="w"> </span><span class="m">4000</span><span class="w"> </span>-CommanderScript<span class="w"> </span>monitor_test1.jlink
</pre></div>
</div>
</div>
</section>
</section>
<section id="comprehensive-debugging-scripts">
<h3><span class="section-number">3.5.3. </span>Comprehensive Debugging Scripts<a class="headerlink" href="#comprehensive-debugging-scripts" title="Link to this heading"></a></h3>
<section id="hardware-validation">
<h4><span class="section-number">3.5.3.1. </span>Hardware Validation<a class="headerlink" href="#hardware-validation" title="Link to this heading"></a></h4>
<div class="literal-block-wrapper docutils container" id="id31">
<div class="code-block-caption"><span class="caption-text">ultimate_flash_debug.sh - Complete Hardware Analysis</span><a class="headerlink" href="#id31" title="Link to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;=== EFR32ZG28 Comprehensive Hardware Debug ===&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Board: BRD2705A Rev. A02&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Device: EFR32ZG28B312F1024IM48-A&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="c1"># Create comprehensive debug script</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>comprehensive_debug.jlink<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
<span class="s">device EFR32ZG28B312F1024IM48-A</span>
<span class="s">si SWD</span>
<span class="s">speed 4000</span>
<span class="s">connect</span>

<span class="s">echo &quot;=== Device Information ===&quot;</span>
<span class="s">mem32 0xE000ED00 1</span>
<span class="s">echo &quot;CPUID Register (should be 0x411FD210)&quot;</span>

<span class="s">echo &quot;=== Memory Test ===&quot;</span>
<span class="s">echo &quot;Testing RAM access...&quot;</span>
<span class="s">w32 0x20000000 0x12345678</span>
<span class="s">mem32 0x20000000 1</span>

<span class="s">echo &quot;=== TrustZone Analysis ===&quot;</span>
<span class="s">echo &quot;Testing GPIO register access...&quot;</span>
<span class="s">mem32 0x4003C034 1</span>
<span class="s">echo &quot;(This should fail with &#39;Could not read memory&#39;)&quot;</span>

<span class="s">echo &quot;=== Flash Memory ===&quot;</span>
<span class="s">echo &quot;Flash base address:&quot;</span>
<span class="s">mem32 0x08000000 4</span>

<span class="s">go</span>
<span class="s">sleep 1000</span>
<span class="s">halt</span>

<span class="s">echo &quot;=== Runtime State ===&quot;</span>
<span class="s">regs</span>
<span class="s">EOF</span>

JLinkExe<span class="w"> </span>-CommanderScript<span class="w"> </span>comprehensive_debug.jlink
</pre></div>
</div>
</div>
</section>
</section>
<section id="results-compilation">
<h3><span class="section-number">3.5.4. </span>Results Compilation<a class="headerlink" href="#results-compilation" title="Link to this heading"></a></h3>
<section id="final-test-matrix">
<h4><span class="section-number">3.5.4.1. </span>Final Test Matrix<a class="headerlink" href="#final-test-matrix" title="Link to this heading"></a></h4>
<table class="docutils align-default" id="id32">
<caption><span class="caption-text">Complete Testing Results</span><a class="headerlink" href="#id32" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 20.0%" />
<col style="width: 15.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Test Category</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Result</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Hardware</strong></p></td>
<td><p>J-Link Connection</p></td>
<td><p>✅ Pass</p></td>
<td><p>100% reliable connection</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Flash Programming</strong></p></td>
<td><p>Multiple methods</p></td>
<td><p>✅ Pass</p></td>
<td><p>All binaries flash successfully</p></td>
</tr>
<tr class="row-even"><td><p><strong>CPU Execution</strong></p></td>
<td><p>Runtime monitoring</p></td>
<td><p>✅ Pass</p></td>
<td><p>Code executes, variables update</p></td>
</tr>
<tr class="row-odd"><td><p><strong>GPIO Control</strong></p></td>
<td><p>External tools</p></td>
<td><p>❌ Fail</p></td>
<td><p>TrustZone blocks access</p></td>
</tr>
<tr class="row-even"><td><p><strong>GPIO Control</strong></p></td>
<td><p>SS5 Integration</p></td>
<td><p>✅ Pass</p></td>
<td><p>Full functionality achieved</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TrustZone</strong></p></td>
<td><p>Bypass attempts</p></td>
<td><p>❌ Fail</p></td>
<td><p>Security cannot be bypassed</p></td>
</tr>
<tr class="row-even"><td><p><strong>Documentation</strong></p></td>
<td><p>Comprehensive guide</p></td>
<td><p>✅ Complete</p></td>
<td><p>Full troubleshooting framework</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="id8">
<h3><span class="section-number">3.5.5. </span>Files Created<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<p>Testing Framework:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test Programs</span>
<span class="n">test1_minimal_blink</span><span class="o">.</span><span class="n">c</span>        <span class="c1"># Progressive test case 1</span>
<span class="n">test2_register_inspect</span><span class="o">.</span><span class="n">c</span>     <span class="c1"># Hardware inspection</span>
<span class="n">test3_alternative_gpio</span><span class="o">.</span><span class="n">c</span>     <span class="c1"># Alternative GPIO methods</span>

<span class="c1"># Debug Scripts</span>
<span class="n">ultimate_troubleshooting</span><span class="o">.</span><span class="n">sh</span>  <span class="c1"># Progressive debugging</span>
<span class="n">ultimate_flash_debug</span><span class="o">.</span><span class="n">sh</span>      <span class="c1"># Comprehensive analysis</span>
<span class="n">trustzone_definitive_fix</span><span class="o">.</span><span class="n">sh</span>  <span class="c1"># TrustZone analysis</span>

<span class="c1"># Monitoring Tools</span>
<span class="n">monitor_after_ss5</span><span class="o">.</span><span class="n">sh</span>         <span class="c1"># Runtime monitoring</span>
<span class="n">interactive_flash_debug</span><span class="o">.</span><span class="n">sh</span>   <span class="c1"># Interactive debugging</span>
</pre></div>
</div>
</section>
</section>
<section id="development-journey-summary">
<h2><span class="section-number">3.6. </span>Development Journey Summary<a class="headerlink" href="#development-journey-summary" title="Link to this heading"></a></h2>
<section id="key-learnings">
<h3><span class="section-number">3.6.1. </span>Key Learnings<a class="headerlink" href="#key-learnings" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>TrustZone Reality</strong>: Hardware security cannot be bypassed with external tools</p></li>
<li><p><strong>Official Tools Necessity</strong>: Silicon Labs ecosystem required for full functionality</p></li>
<li><p><strong>Multiple Approaches Value</strong>: Different methods provide different insights</p></li>
<li><p><strong>Documentation Importance</strong>: Comprehensive troubleshooting essential</p></li>
<li><p><strong>Hardware Quality</strong>: EFR32ZG28 and BRD2705A are fully functional</p></li>
</ol>
</section>
<section id="timeline-overview">
<h3><span class="section-number">3.6.2. </span>Timeline Overview<a class="headerlink" href="#timeline-overview" title="Link to this heading"></a></h3>
<table class="docutils align-default" id="id33">
<caption><span class="caption-text">Development Timeline</span><a class="headerlink" href="#id33" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Phase</p></th>
<th class="head"><p>Duration</p></th>
<th class="head"><p>Key Activities</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1</strong></p></td>
<td><p>Initial</p></td>
<td><p>Standard Contiki-NG integration attempt</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2</strong></p></td>
<td><p>Extended</p></td>
<td><p>Multiple bare metal approaches</p></td>
</tr>
<tr class="row-even"><td><p><strong>3</strong></p></td>
<td><p>Focused</p></td>
<td><p>TrustZone security analysis</p></td>
</tr>
<tr class="row-odd"><td><p><strong>4</strong></p></td>
<td><p>Solution</p></td>
<td><p>SS5 integration and success</p></td>
</tr>
<tr class="row-even"><td><p><strong>5</strong></p></td>
<td><p>Validation</p></td>
<td><p>Comprehensive testing framework</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id9">
<h3><span class="section-number">3.6.3. </span>Success Metrics<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<p><strong>Final Achievement</strong>: ✅ <strong>Complete Success</strong></p>
<ul class="simple">
<li><p>6 different solution approaches documented</p></li>
<li><p>TrustZone security fully analyzed and documented</p></li>
<li><p>Working SS5 integration with visible LED control</p></li>
<li><p>Comprehensive development framework created</p></li>
<li><p>92 files providing complete ecosystem</p></li>
</ul>
<p><strong>Project Status</strong>: ✅ <strong>COMPLETE</strong> - All objectives achieved with multiple working solutions.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hardware.html" class="btn btn-neutral float-left" title="2. Hardware Specifications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="solutions-implemented.html" class="btn btn-neutral float-right" title="4. Solutions Implemented" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, PHYTEC EMBEDDED PVT. LTD. - SANGEZHIL &amp; ABARNIKA &amp; MADHUMITHA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>